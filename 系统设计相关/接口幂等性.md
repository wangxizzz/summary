# 概念
幂等性, 通俗的说就是一个接口, 多次发起同一个请求, 必须保证操作只能执行一次
比如:

- 订单接口, 不能多次创建订单,既不能出现重复的订单保存到db中。
- 支付接口, 重复支付同一笔订单只能扣一次钱
- 支付宝回调接口, 可能会多次回调, 必须处理重复回调
- 普通表单提交接口, 因为网络超时等原因多次点击提交, 只能成功一次
等等
# 常见解决方案
- 唯一索引 -- 防止新增脏数据（比如orderNo为唯一索引，或者多列建唯一复合索引）
- token机制 -- 防止页面重复提交
    - 每次请求接口，先请求后端生成一个token,存入redis，然后返回前端
    - 前端带着header中的token请求后端接口，后端请求redis验证token是否存在
        - 如果存在，那么验证通过，删掉token，下次再来请求,token无，验证不通过。
        - 如果不存在，验证不通过
    - 此方案存在问题，待商榷。
- 悲观锁 -- 获取数据的时候加锁(锁表或锁行)
- 乐观锁 -- 基于版本号version实现, 在更新数据那一刻校验数据(update with version, 每次更新时先查出version，然后带着version去update)
- 分布式锁 -- redis(jedis、redisson)或zookeeper实现
- 状态机 -- 状态变更, 更新数据时判断状态(update with status)